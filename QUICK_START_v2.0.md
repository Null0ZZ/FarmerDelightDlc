# ⚡ 快速上手 v2.0 - 新功能演示

> **版本**：2.0  
> **主要改进**：子节点不重叠、支持拖动节点、支持拖拽视窗

---

## 🎮 新功能演示

### 功能 1️⃣：子节点自动分散排列

**之前** ❌：
```
[父节点]
  ├─ [子节点1] ┐
  ├─ [子节点2] │ 重叠！
  └─ [子节点3] ┘
```

**现在** ✅：
```
       [子节点3]
          ↑
   [子节点4] ← [父节点] → [子节点1]
          ↓
       [子节点2]
```

**操作**：
```
1. 点击一个节点（选中）
2. 右侧菜单 → [➕ 创建子节点]
3. 重复上步创建多个子节点
4. 自动按圆形排列！✨
```

---

### 功能 2️⃣：长按拖动移动节点

**操作**：
```
1. 长按（左键按住）一个节点
2. 拖动鼠标（节点跟随）
3. 释放鼠标（节点固定）
```

**视觉反馈**：
- 按住时：手形光标变成 "抓紧" 状
- 拖动时：节点浮在最上层
- 连线：实时跟随更新

**示例**：
```
初始状态：        拖动中：          完成后：
[节点A]           [节点A]          [节点A]
  │       → 拖拽 →  │       →       │
[节点B]           [节点B]          [节点B]
                 （移动了）
```

---

### 功能 3️⃣：在背景拖拽移动整个视窗

**操作**：
```
1. 在两个节点之间的空白处长按
2. 拖动鼠标
   - 向右拖 → 显示右侧内容
   - 向下拖 → 显示下方内容
3. 释放鼠标（视窗固定）
```

**对比之前**：
| 操作 | 之前 | 现在 |
|------|------|------|
| 向下查看 | 使用滚动条 | 在空白处拖下来 |
| 向右查看 | 不支持 | 在空白处拖右边 |
| 速度 | 🐢 需要精确点击滚块 | 🚀 直接拖拽 |

**示例**：
```
画布太大，子节点在右下角，怎么看？

方法 1（之前）：
  点击水平滚条 → 等待 → 没对齐 → 再调整

方法 2（现在）✨：
  在空白处向右下拖拽 → 立即看到右下角节点
  一次操作搞定！
```

---

### 功能 4️⃣：物品网格优化

**对比**：

| 方面 | v1.0 | v2.0 | 效果 |
|------|------|------|------|
| 每行列数 | 10 列 | 15 列 | 显示更多 |
| 字体大小 | 20px | 14px | 更紧凑 |
| 一屏数量 | ~20 个 | ~30 个 | +50% |

**效果**：
```
之前：              现在：
[🌾] [⚒️] [🔨]   [🌾][⚒️][🔨][💎][🌲][📦][🎫][🍖][🥘][🧂][🥙][🍞][🌽][🥕][🧄]
[💎] [🌲] [📦]   [🧅][🥬][🍅][🍌][🥝][🍎][🥒][🥒][🍉][🍊][🍋][🥬][🌽][🥕][🧂]
需要翻页... →    看得清！不用翻页！
```

---

## 📖 完整操作流程

### 场景：创建一个大型成就树

```
目标：创建一个根节点和多个子节点、孙节点的成就树
```

#### 步骤 1：创建根节点

```
菜单 → [⭐ 编辑节点]
右侧按钮 → [➕ 创建根节点]

✓ 一个新节点出现在画布上
```

#### 步骤 2：为根节点分配物品

```
点击该节点（它会高亮）
右侧菜单 → [📦 设置物品]
在物品选择器中：
  [全部] [工具] [食物] ...
   ↑     ↑ 点这个
        15 列网格，非常紧凑
        向下滚动看更多
  选择一个物品（比如 ⚒️）
  关闭对话框

✓ 节点上现在显示 ⚒️ 图标
```

#### 步骤 3：创建第一批子节点

```
确保根节点还是选中的（高亮）
右侧菜单 → [➕ 创建子节点]

✓ 新节点在 0° 方向（右侧）出现

右侧菜单 → [➕ 创建子节点]
✓ 新节点在 60° 方向出现

右侧菜单 → [➕ 创建子节点]
✓ 新节点在 120° 方向出现

结果：
           [子3]
          ↗
  [子2] ← [根] → [子1]  ← 均匀分布！
```

#### 步骤 4：调整节点位置（可选）

```
如果某个节点位置不满意：
  长按该节点 → 拖到新位置 → 释放

✓ 节点移到新位置，连线实时跟随
```

#### 步骤 5：为子节点添加物品

```
选中子节点1
[📦 设置物品] → 选择一个物品 → 关闭

重复步骤为其他子节点添加物品
```

#### 步骤 6：为子节点创建孙节点

```
选中子节点1
[➕ 创建子节点]

✓ 孙节点围绕子节点1 排列

为孙节点添加物品
```

#### 步骤 7：快速浏览整个成就树

```
现在子节点太多，画布很大，怎么查看？

方法1（滚动条）：拖动滚条 → 等待 → 看到内容
方法2（背景拖拽）✨：
  在空白处向右拖 → 立即看到右侧内容
  在空白处向下拖 → 立即看到下方内容
  推荐使用方法 2，更快更直观！
```

#### 步骤 8：保存更改

```
右下角按钮 → [✅ 保存更改]

✓ 成就树已保存到数据库
```

---

## 🎯 常见操作速查表

### 快速参考

| 想要做的事 | 操作步骤 |
|-----------|--------|
| 创建节点 | 菜单 → [⭐ 编辑节点] → [➕ 创建根节点] |
| 创建子节点 | 选中父节点 → [➕ 创建子节点] |
| 分配物品 | 选中节点 → [📦 设置物品] → 选择 |
| 调整位置 | 长按节点 → 拖动 → 释放 |
| 浏览整个树 | 在空白处拖拽背景 |
| 删除节点 | 选中 → [🗑️ 删除节点] |
| 保存更改 | 右下角 [✅ 保存更改] |

### 快速拖动技巧

**场景：节点太多，想一次看到全部**

```
方法：在空白处大范围拖拽

示例：想看右上角的节点
  在左下角空白处 → 向右上拖大距离 → 释放
  画面一下子转移到右上角！🚀
```

**场景：想对齐两个节点**

```
方法：逐个拖动节点到目标位置

步骤：
  1. 长按第一个节点
  2. 拖到参考线位置 → 释放
  3. 长按第二个节点
  4. 拖到同一水平线 → 释放
  5. 现在两个节点完全对齐！
```

---

## ⚡ 性能提示

### 什么时候应该使用哪种操作方式

**场景 1：微调单个节点位置**
```
使用：长按拖动节点
原因：精确到像素，不影响其他节点
```

**场景 2：查看其他区域的节点**
```
使用：背景拖拽视窗
原因：快速浏览，不改变节点位置
```

**场景 3：自动排列子节点**
```
使用：连续点击 [➕ 创建子节点]
原因：自动计算位置，无需手动调整
```

### 卡顿排查

如果拖动时出现卡顿：
- ✅ 检查节点数量（100+ 节点会变慢）
- ✅ 关闭其他浏览器标签页
- ✅ 刷新页面重新加载
- ✅ 确保浏览器是最新版本

---

## 🎨 视觉效果说明

### 拖动时的视觉反馈

```
节点上按住              空白处按住
↓                      ↓
hand-grab cursor  →   hand-grab cursor
  │                     │
node.zIndex = 9    →  整个画布可移动
  │                     │
实时显示位置         实时显示滚动
  │                     │
释放鼠标              释放鼠标
  ↓                    ↓
节点固定在新位置    视窗固定在新位置
```

### 连线动画

```
子节点到父节点的连线：
  • 颜色：绿色 rgba(124, 242, 156)
  • 样式：直线连接
  • 动画：泛光呼吸效果（2 秒一个周期）
  • 箭头：指向父节点
  
拖动节点时：
  • 连线立即更新（无延迟）
  • 动画继续流畅播放
  • 泛光效果随之移动
```

---

## 🔧 自定义设置

### 如果你想调整参数

所有可调整的参数都在代码中标注，位置：
`src/components/AchievementNodeEditor.tsx`

**可调整的参数**：

| 参数 | 值 | 说明 |
|------|-----|------|
| 子节点间隔度数 | 60 | 改大 → 排列更分散，改小 → 更密集 |
| 距离父节点像素 | 150 | 改大 → 子节点离父节点更远，改小 → 更近 |
| 物品网格列数 | 15 | 改大 → 一行更多物品，改小 → 一行更少 |

**修改方式**：
```typescript
// 找到这一行
const radius = 150; // 子节点距离父节点的距离

// 改成你想要的值
const radius = 200; // 现在子节点离得更远了

// 保存文件 → npm run build → 完成！
```

---

## 📱 浏览器兼容性

| 浏览器 | 支持情况 | 备注 |
|--------|--------|------|
| Chrome | ✅ 完全支持 | 推荐 |
| Firefox | ✅ 完全支持 | 推荐 |
| Safari | ✅ 完全支持 | 需要最新版 |
| Edge | ✅ 完全支持 | Chromium 内核 |
| IE | ❌ 不支持 | 太老了 |

---

## 🆘 故障排查

### 问题：拖动节点时看不到的地方

**解决**：
```
这是正常的！当你向右下拖动超出屏幕时：
  1. 继续拖动鼠标（超出屏幕也没关系）
  2. 释放鼠标
  3. 你的节点会在右下方，
     可以用背景拖拽返回来看它
```

### 问题：背景拖拽时拖动不了

**原因和解决**：
```
❌ 错误：点击在节点上 → 拖动 → 节点被拖了，不是视窗
✅ 正确：点击在节点之间的空白 → 拖动 → 视窗移动
```

### 问题：连线断了（看不见）

**原因和解决**：
```
❌ 可能被拖到了屏幕外
✅ 使用背景拖拽将视窗向反方向移动
✅ 或者拖动该节点回到可见范围
```

---

## 💡 最佳实践

### 创建大型成就树的建议

```
1. 先创建骨架
   创建所有根节点和第一层子节点
   暂时不调整位置

2. 预览整体布局
   使用背景拖拽浏览整个树
   看看是否有重叠或太密集的区域

3. 微调节点位置
   对不满意的节点进行微调
   使用拖动功能精确放置

4. 添加物品和描述
   为每个节点设置物品
   添加相关描述

5. 最后检查
   再次浏览整个树
   检查连线是否正确
   保存更改

6. 导出备份
   导出节点数据作为备份
   防止意外丢失
```

### 性能优化建议

```
如果节点很多，保持流畅的方法：

1. 分模块管理
   不要在一个编辑器中放 200+ 个节点
   改为分成多个小模块

2. 定期保存
   避免长时间编辑后突然刷新丢失
   经常点击保存按钮

3. 清理废弃节点
   删除不用的测试节点
   保持整体数量在 100 以内
```

---

**现在就开始体验新功能吧！** 🚀

访问：http://localhost:5173/
菜单：⭐ 编辑节点
